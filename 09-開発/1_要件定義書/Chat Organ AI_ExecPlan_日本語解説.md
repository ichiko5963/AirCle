# Chat Organ AI 実行計画書 - 中学生にもわかる解説

この文書は、Chat Organ AIというプロジェクトをどうやって作るかを説明した「実行計画書」です。まるで、大きな家を建てるための設計図と工事手順書を合わせたようなものです。

---

## 📋 この計画書について

この計画書は、`PLANS.md.md`という別のファイルに書かれているルールに従って作られています。そして、この計画書だけを読めば、初心者でもChat Organ AIを作れるように、必要な情報がすべて含まれています。

**わかりやすく言うと：** 料理のレシピ本のように、この本さえあれば、料理をしたことがない人でも作れるようになっているということです。

---

## 🎯 目的と全体像（Purpose / Big Picture）

### 何を作るのか？

会社や学校で使う、**「全部が一つになった便利な作業スペース」**を作ります。

### 具体的には？

例えば、あなたが学校のクラスで使うとすると：

1. **チャット機能**：クラスメンバーとメッセージをやり取りできる（LINEみたいなもの）
2. **タスク管理**：やるべきことをリストにして管理できる（宿題リストみたいなもの）
3. **知識ベース**：過去の会話や資料を検索して、必要な情報を見つけられる（図書館みたいなもの）
4. **自動化機能**：決まった時間に自動でリマインダーを送ってくれる（アラームみたいなもの）
5. **AI機能**：会話から自動で「やること」を提案してくれる（賢いアシスタントみたいなもの）

これらが全部、**同じ画面で、同じタイムライン（時間軸）で動く**ようにします。

### 成功の基準

実際に動かしてみて、以下のことができるようになれば成功です：

1. チャット画面でメッセージを送る
2. AIが「これはタスクにしたら？」と提案してくれる
3. その提案をクリックしてタスクにする
4. 自動でリマインダー（思い出し通知）が来る
5. 過去の資料を検索して、質問に答えてくれる

**わかりやすく言うと：** スマホのアプリを開いて、メッセージを送ったら、AIが「これやったら？」と提案してくれて、それをタスクにして、後で「やった？」と自動で聞いてくれる、そんなシステムです。

---

## 📊 進捗状況（Progress）

チェックリスト形式で、何が終わって、何がまだかを示しています。

- ✅ **完了したこと**：
  - MVP（最小限の機能）→β版（テスト版）→GA版（正式版）の範囲を決めて、この計画書を作った（2025年2月14日）

- ⬜ **まだやっていないこと**：
  1. 要件定義書とデータ設計図を作る（2025年2月14日予定）
  2. 画面のデザインとチャット・タスクの流れを作る（2025年2月14日予定）
  3. サーバー側のプログラムと自動化・AI機能を動かす（2025年2月14日予定）
  4. 外部サービスとの連携、分析機能、セキュリティ機能、テストを完成させる（2025年2月14日予定）

**わかりやすく言うと：** 家を建てる計画はできたけど、まだ実際の工事は始まっていない状態です。

---

## 🔍 発見したこと（Surprises & Discoveries）

### 重要な発見

今、動いているアプリは`create-next-app`という名前の、**まだ何も機能が入っていないテンプレート**だけです。チャットもタスクもAIも何も入っていません。

**わかりやすく言うと：** 家の骨組みだけあって、壁もドアも何もない状態です。だから、最初から作り直す必要があります。

---

## 📝 決定事項の記録（Decision Log）

### 決定1：フロントエンド（画面側）の技術を選ぶ

**何を選んだか：** `create-next-app`というNext.jsという技術を使うことにしました。

**なぜか：** すでにTailwind（デザインの道具）、Supabase（認証の道具）、AI SDK（AIの道具）が入っているから、時間を節約できます。

**わかりやすく言うと：** すでに道具箱が揃っているので、それをそのまま使うことにしました。

### 決定2：バックエンド（サーバー側）を新しく作る

**何を選んだか：** NestJSという技術で、新しいサーバーを作ることにしました。Temporal（自動化の道具）、PostgreSQL（データベース）、Redis（高速な記憶装置）、OpenSearch（検索エンジン）を使います。

**なぜか：** 必要な機能（複数のAIエージェント、権限管理、自動化ルール、GitHub連携）が、今のフロントエンドだけでは足りないからです。

**わかりやすく言うと：** 画面だけでは足りないので、裏側で動く強力なサーバーを新しく作ることにしました。

---

## 📈 成果と振り返り（Outcomes & Retrospective）

今のところ、まだコードは何も書いていません。計画書を作っただけです。実際に動かしてみて、計画通りにいったかどうかを、ここに記録していきます。

**わかりやすく言うと：** まだ何も作っていないので、成果はありません。これから作って、うまくいったかどうかをここに書いていきます。

---

## 🗂️ 文脈と方向性（Context and Orientation）

### 今あるもの

1. **`create-next-app`**：Next.jsという技術で作られた、まだ何も入っていないテンプレート
2. **`ChatOrganAI_UI_Mock.html`**：画面がどんな感じかを見るための、試作品のHTMLファイル
3. **`ChatOrganAI_Security_Operations_Runbook.md`**：セキュリティと運用について書かれたマニュアル

### まだないもの

- サーバー側のプログラム（バックエンド）
- データベースの設計
- 検索エンジンの設定

### 専門用語の説明

- **RAG（Retrieval-Augmented Generation）**：過去の資料を検索して、その内容を元にAIが答える技術。まるで、図書館で本を探して、その本を読んで答えるようなもの。
- **STT（Speech-To-Text）**：音声を文字に変換する技術。スマホの音声入力みたいなもの。
- **Temporal**：自動化のための道具。決まった時間に自動で何かを実行したり、リマインダーを送ったりできる。

**わかりやすく言うと：** 今あるのは設計図と試作品だけで、実際に動くものはまだ何もありません。

---

## 🛠️ 作業計画（Plan of Work）

### ステップ1：要件定義書を作る

**何をするか：**
- ユーザーが「こういう機能が欲しい」と言った内容を、番号を付けて整理した文書を作る
- データの関係を図にしたもの（ERD：エンティティ関係図）を作る
- AIに何をさせるかの指示書（プロンプト）を作る

**わかりやすく言うと：** 家を建てる前に、どんな部屋が何個必要か、どこに何を置くかを図に書いて整理します。

### ステップ2：画面（フロントエンド）を作る

**何をするか：**
- `create-next-app`を改造して、実際に使える画面にする
- チャット画面、タスク画面、知識検索画面、自動化設定画面、分析画面、管理画面、設定画面を作る
- リアルタイムで更新されるようにする（WebSocketという技術を使う）

**わかりやすく言うと：** 家の内装を作って、リビング、キッチン、寝室など、それぞれの部屋を完成させます。

### ステップ3：サーバー（バックエンド）を作る

**何をするか：**
- NestJSという技術でサーバーを作る
- 認証、ユーザー管理、部署管理、チャンネル管理、メッセージ管理、タスク管理、議事録管理、知識管理、自動化、外部連携、分析の機能を作る
- PostgreSQL（データベース）、Redis（高速記憶）、OpenSearch（検索エンジン）を設定する
- リアルタイム通信のためのSocket.IOを設定する
- 音声を文字に変換する機能（Whisper）を追加する
- GitHubやカレンダーと連携する機能を追加する
- 権限管理（Owner/Admin/Manager/Member/Guest）を実装する

**わかりやすく言うと：** 家の電気や水道、ガスなどのインフラを整備して、家がちゃんと動くようにします。

### ステップ4：AIと自動化の機能を作る

**何をするか：**
- 議事録AI：音声の文字起こしを受け取って、議題・決定事項・アクションアイテムをまとめる
- 知識AI：質問を受け取って、過去の資料を検索して答える
- 自動化AI：決まったルールに従って、自動で作業を実行する
- DevOps AI：GitHubの作業を自動で実行して、結果をまとめる

**わかりやすく言うと：** 家に賢いロボットを置いて、自動で掃除したり、料理したり、質問に答えてくれるようにします。

### ステップ5：インフラとセキュリティを整える

**何をするか：**
- Terraformという技術で、データベースやサーバーを自動で構築できるようにする
- Dockerという技術で、アプリをコンテナ（箱）に入れて、どこでも動くようにする
- CI/CD（自動テスト・自動デプロイ）を設定する
- 監視ダッシュボードを作って、システムが正常に動いているか見られるようにする
- 分析機能：参加率、反応の傾向、未回答のスレッド、週次まとめを計算する
- 監査ログ：誰が何をしたかを記録する

**わかりやすく言うと：** 家のセキュリティシステムを整えて、防犯カメラを設置し、誰がいつ来たかを記録できるようにします。

### ステップ6：テストとドキュメントを作る

**何をするか：**
- 自動テストを作る（画面のテスト、サーバーのテスト、統合テスト）
- 初期データを入れるスクリプトを作る
- 運用マニュアルを作る

**わかりやすく言うと：** 家がちゃんと動くかテストして、使い方のマニュアルを作ります。

---

## 🔧 具体的な手順（Concrete Steps）

実際にコマンドを実行する手順です。

### 1. フロントエンドの準備

```bash
cd /Users/ichiokanaoto/create-next-app
npm install
```

**何をしているか：** 必要な道具（ライブラリ）をダウンロードしています。

### 2. プロジェクト構造を整理

```bash
cd /Users/ichiokanaoto
pnpm dlx create-turbo@latest chat-organ-ai && mv create-next-app chat-organ-ai/apps/web
```

**何をしているか：** 複数のアプリを一つのプロジェクトにまとめています（モノレポ構造）。

**わかりやすく言うと：** 複数の建物を一つの敷地にまとめて、管理しやすくしています。

### 3. バックエンドの準備

```bash
cd /Users/ichiokanaoto/chat-organ-ai
npx @nestjs/cli new chat-organ-ai-server --package-manager pnpm
```

**何をしているか：** サーバー側のプログラムの骨組みを作っています。

### 4. データベースと検索エンジンを起動

```bash
docker compose -f infra/docker-compose.dev.yml up -d
```

**何をしているか：** Dockerという技術で、データベースや検索エンジンを起動しています。

**わかりやすく言うと：** 家の電気や水道を動かすための設備を起動しています。

### 5. データベースのテーブルを作る

```bash
cd chat-organ-ai/apps/server
pnpm prisma migrate dev --name init_core_schema
```

**何をしているか：** データを保存するためのテーブル（表）を作っています。

**わかりやすく言うと：** 本棚や引き出しを作って、どこに何を置くかを決めています。

### 6. 自動化とAIのプログラムを起動

```bash
pnpm --filter automation-worker dev
pnpm --filter ai-agents dev
```

**何をしているか：** 自動化とAIのプログラムを起動しています。

### 7. フロントエンドとバックエンドを起動

```bash
pnpm --filter web dev
pnpm --filter chat-organ-ai-server start:dev
```

**何をしているか：** 画面とサーバーを起動して、実際に動かしてみます。

---

## ✅ 検証と承認（Validation and Acceptance）

### どうやって「完成した」と判断するか？

実際に動かしてみて、以下のことができることを確認します：

1. **ログイン**：SSO（シングルサインオン）でログインできる
2. **ワークスペース作成**：新しいワークスペースを作れる
3. **部署招待**：少なくとも1つの部署を招待できる
4. **チャット投稿**：チャット画面でメッセージを送れる
5. **AI提案**：メッセージからAIがタスクを提案してくれる
6. **タスク作成**：提案をクリックしてタスクにできる
7. **リマインダー**：タスクにリマインダーが自動で設定される（3日前、1日前、6時間前）
8. **音声アップロード**：音声ファイルをアップロードできる
9. **議事録生成**：音声から議事録（議題・決定事項・アクション）が作られる
10. **知識検索**：質問をして、過去の資料を元に答えてくれる
11. **自動化実行**：週次まとめなどの自動化が動く
12. **GitHub連携**：GitHubのPR（プルリクエスト）のリンクが展開されて、情報が表示される
13. **テスト通過**：すべてのテストが通る

**わかりやすく言うと：** 家が完成したかどうかは、実際に住んでみて、水が出るか、電気がつくか、ドアが開くかを確認します。

---

## 🔄 冪等性と回復（Idempotence and Recovery）

### 冪等性とは？

何回実行しても結果が同じになることです。

**わかりやすく言うと：** スイッチを何回押しても、同じ結果になることです。1回押しても2回押しても、電気はつきます。

### 何をしているか？

- TerraformとDocker Composeは、何回実行しても安全にできるようにする
- データベースの変更は、途中で止まっても再開できるようにする
- Temporalのワークフローは、止まったら再開できるようにする
- 自動化ルールは、同じ作業を2回しないようにする
- ロールバック（元に戻す）手順を用意する

**わかりやすく言うと：** 工事中に失敗しても、元に戻せるように準備しておきます。

---

## 📦 成果物とメモ（Artifacts and Notes）

### 何を記録するか？

実装中に重要な証拠を記録します：

- ERDの図（データの関係図）
- ワークスペースのスクリーンショット
- AIが正しく動いていることを証明するログ
- 自動化の実行例

これらを`artifacts/chat-organ-ai/`というフォルダに保存します。

**わかりやすく言うと：** 工事の写真を撮って、後で見返せるようにします。

---

## 🔌 インターフェースと依存関係（Interfaces and Dependencies）

### フロントエンドが使う技術

- **Next.js 15**：画面を作るためのフレームワーク
- **Tailwind**：デザインを簡単にする道具
- **Radix UI**：UIコンポーネントのライブラリ
- **Supabase**：認証の道具
- **Socket.IO**：リアルタイム通信の道具
- **AI SDK**：AI機能を使うための道具

### バックエンドが使う技術

- **NestJS**：サーバーを作るためのフレームワーク
- **PostgreSQL**：データベース（pgvector拡張付き）
- **Redis**：高速な記憶装置
- **OpenSearch**：検索エンジン
- **S3**：ファイル保存用のストレージ
- **Temporal**：自動化のための道具
- **Whisper**：音声を文字に変換するAI
- **GitHub API**：GitHubと連携する
- **Google Calendar API**：カレンダーと連携する

### 主要なエンドポイント（API）

- `POST /messages`：メッセージを送信
- `POST /tasks`：タスクを作成
- `POST /minutes`：議事録を作成
- `POST /automations/rules`：自動化ルールを作成
- `GET /analytics/engagement`：分析データを取得

### WebSocketチャンネル

- `message.created`：メッセージが作成されたとき
- `task.updated`：タスクが更新されたとき
- `automation.executed`：自動化が実行されたとき

### 権限管理（RBAC）

- **Owner**：オーナー（すべての権限）
- **Admin**：管理者（ほとんどの権限）
- **Manager**：マネージャー（一部の権限）
- **Member**：メンバー（基本的な権限）
- **Guest**：ゲスト（閲覧のみ）

**わかりやすく言うと：** 家を建てるために必要な道具と、それらがどう連携するかを説明しています。

---

## 📅 変更記録

- **2025年2月14日**：最初の実行計画書を作成しました。

---

## 🎓 まとめ

この計画書は、Chat Organ AIという「全部が一つになった便利な作業スペース」を作るための、完全な設計図と手順書です。

**主なポイント：**

1. **目的**：チャット、タスク、知識、自動化、AIが全部一つになったシステムを作る
2. **現状**：まだ計画段階で、実際のコードは書いていない
3. **手順**：要件定義→画面作成→サーバー作成→AI機能→インフラ→テストの順で進める
4. **検証**：実際に動かして、すべての機能が動くことを確認する
5. **安全性**：失敗しても元に戻せるように準備する

まるで、大きな家を建てるように、一つ一つ丁寧に作っていく計画です。



